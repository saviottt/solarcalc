<!DOCTYPE html>
<html>
<head>
    <title>Kerala Smart Solar Intelligence</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f6f9;
            text-align: center;
            padding: 40px;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 450px;
            margin: auto;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        input {
            width: 92%;
            padding: 8px;
            margin: 6px 0;
        }

        button {
            padding: 10px 20px;
            background: #28a745;
            color: white;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background: #218838;
        }

        .result {
            margin-top: 20px;
            text-align: left;
        }

        .positive {
            color: green;
            font-weight: bold;
        }

        .negative {
            color: red;
            font-weight: bold;
        }

        hr {
            margin: 15px 0;
        }
    </style>
</head>
<body>

<h1>‚òÄ Kerala Smart Solar + EV Intelligence</h1>

<div class="container">

    <input type="number" id="lat" placeholder="Latitude (e.g. 9.93)">
    <input type="number" id="lon" placeholder="Longitude (e.g. 76.26)">
    <input type="number" id="month" placeholder="Month (1-12)">
    <input type="number" id="size" placeholder="System Size (kW)">
    <input type="number" id="tariff" placeholder="Buying Tariff (‚Çπ per unit)">
    <input type="number" id="consumption" placeholder="Monthly Home Consumption (kWh)">

    <hr>

    <input type="number" id="ev_km" placeholder="EV Daily KM (e.g. 30)">
    <input type="number" id="ev_eff" placeholder="EV Efficiency (km per kWh e.g. 6)">
    <input type="number" id="export_tariff" placeholder="Export Tariff (‚Çπ per unit sold to KSEB)">

    <button onclick="calculate()">Calculate</button>

    <div class="result" id="result"></div>

</div>

<script>
async function calculate() {

    const data = {
        Latitude: parseFloat(document.getElementById("lat").value),
        Longitude: parseFloat(document.getElementById("lon").value),
        Month: parseInt(document.getElementById("month").value),
        System_Size: parseFloat(document.getElementById("size").value),
        Tariff: parseFloat(document.getElementById("tariff").value),
        Monthly_Consumption: parseFloat(document.getElementById("consumption").value),
        EV_Daily_KM: parseFloat(document.getElementById("ev_km").value) || 0,
        EV_Efficiency: parseFloat(document.getElementById("ev_eff").value) || 1,
        Export_Tariff: parseFloat(document.getElementById("export_tariff").value) || 0
    };

    const response = await fetch("http://127.0.0.1:8000/predict", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
    });

    const result = await response.json();

    let surplusClass = result.Surplus_or_Deficit_kWh >= 0 ? "positive" : "negative";
    let surplusText = result.Surplus_or_Deficit_kWh >= 0 
        ? "Surplus Energy (Sold to Grid)" 
        : "Deficit (Buying from Grid)";

    document.getElementById("result").innerHTML = `
        <h3>‚ö° Energy Overview</h3>

        <p><b>Solar Generation:</b> ${result.Solar_Generation_kWh_per_Year} kWh</p>
        <p><b>Home Usage:</b> ${result.Home_Consumption_kWh_per_Year} kWh</p>
        <p><b>EV Usage:</b> ${result.EV_Consumption_kWh_per_Year} kWh</p>
        <p><b>Total Usage:</b> ${result.Total_Usage_kWh_per_Year} kWh</p>

        <p class="${surplusClass}">
            <b>${surplusText}:</b> ${result.Surplus_or_Deficit_kWh} kWh
        </p>

        <hr>

        <h3>üí∞ Financial Breakdown</h3>
        <p><b>Export Income:</b> ‚Çπ${result.Export_Income_Rs}</p>
        <p><b>Grid Purchase Cost:</b> ‚Çπ${result.Grid_Purchase_Cost_Rs}</p>
        <p><b>Annual Net Benefit:</b> ‚Çπ${result.Annual_Net_Benefit_Rs}</p>
        <p><b>Payback Period:</b> ${result.Payback_Years} years</p>

        <hr>

        <h3>üåç Environmental Impact</h3>
        <p><b>CO‚ÇÇ Offset (Yearly):</b> ${result.CO2_Offset_Tons_per_Year} tons</p>

        <hr>

        <h3>üìà 25-Year Projection</h3>
        <p><b>Total Savings (25 Years):</b> ‚Çπ${result["25_Year_Total_Savings_Rs"]}</p>
        <p><b>Net Profit (25 Years):</b> ‚Çπ${result["25_Year_Net_Profit_Rs"]}</p>
    `;
}
</script>

</body>
</html>
